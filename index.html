<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Red Guyava Earning</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary: #E74C3C;
            --primary-dark: #C0392B;
            --bg-dark: #1B2631;
            --card-bg: rgba(44, 62, 80, 0.7);
        }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-dark);
            color: #ffffff;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        .guava-gradient {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        }
        .glass-card {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(231, 76, 60, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }
        .tab-content {
            display: none;
            animation: slideUp 0.35s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .tab-content.active {
            display: block;
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .loader {
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 50%;
            border-top: 2px solid #ffffff;
            width: 18px;
            height: 18px;
            animation: spin 0.8s linear infinite;
            display: inline-block;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .nav-btn.active {
            color: var(--primary);
            transform: translateY(-2px);
        }
        .nav-btn.active i {
            filter: drop-shadow(0 0 8px var(--primary));
        }
        input::placeholder {
            color: rgba(255,255,255,0.3);
        }
        .btn-press:active {
            transform: scale(0.95);
        }
        .balance-text {
            text-shadow: 0 0 20px rgba(231, 76, 60, 0.4);
        }
    </style>
<script type="importmap">
{
  "imports": {
    "firebase/": "https://esm.sh/firebase@^12.9.0/",
    "react": "https://esm.sh/react@^19.2.4",
    "react/": "https://esm.sh/react@^19.2.4/"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body class="pb-28">
    <!-- Header -->
    <header class="p-4 glass-card border-b border-gray-800 sticky top-0 z-50 flex items-center justify-between">
        <div class="flex items-center gap-2">
            <div class="w-9 h-9 rounded-xl guava-gradient flex items-center justify-center shadow-lg">
                <i class="fas fa-leaf text-white text-sm"></i>
            </div>
            <div>
                <h1 class="font-bold text-base leading-tight">Red <span class="text-[#E74C3C]">Guyava</span></h1>
                <p class="text-[10px] text-gray-400 font-medium tracking-widest uppercase">Premium Earning</p>
            </div>
        </div>
        <div class="flex items-center gap-2 px-3 py-1.5 bg-gray-900/50 rounded-full border border-gray-700/50">
            <i class="fas fa-coins text-yellow-500 text-xs"></i>
            <span id="header-balance" class="text-xs font-bold text-white tracking-tight">à§³0.00</span>
        </div>
    </header>

    <main class="p-4 max-w-md mx-auto min-h-[calc(100vh-160px)]">
        <!-- Home Tab -->
        <section id="home" class="tab-content active space-y-6">
            <div class="guava-gradient p-6 rounded-3xl shadow-xl relative overflow-hidden">
                <div class="relative z-10">
                    <h2 class="text-white text-xl font-bold mb-1">Welcome, <span id="user-name">User</span>! ðŸ‘‹</h2>
                    <p id="welcome-msg" class="text-red-100 text-sm opacity-90 font-light">Start completing tasks to earn rewards.</p>
                </div>
                <div class="absolute -top-6 -right-6 opacity-10">
                    <i class="fas fa-leaf text-[180px] rotate-12"></i>
                </div>
            </div>

            <div class="glass-card p-8 rounded-3xl flex flex-col items-center justify-center text-center relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-1 guava-gradient opacity-50"></div>
                <span class="text-gray-400 text-[10px] font-bold mb-2 uppercase tracking-[0.2em]">Available Balance</span>
                <span id="main-balance" class="text-5xl font-black text-white balance-text tracking-tighter">à§³0.00</span>
                <div class="mt-5 px-5 py-2 bg-[#E74C3C]/10 rounded-2xl border border-[#E74C3C]/20">
                    <p class="text-[#E74C3C] text-[11px] font-bold uppercase tracking-wider flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full bg-[#E74C3C] animate-pulse"></span>
                        Ready for Cashout
                    </p>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div class="glass-card p-4 rounded-2xl flex flex-col items-center border-l-4 border-l-blue-500">
                    <div class="w-10 h-10 rounded-xl bg-blue-500/10 flex items-center justify-center mb-2">
                        <i class="fas fa-shield-check text-blue-500"></i>
                    </div>
                    <span class="text-[10px] text-gray-400 font-bold uppercase">Account Status</span>
                    <span class="text-sm font-bold text-white">Verified</span>
                </div>
                <div class="glass-card p-4 rounded-2xl flex flex-col items-center border-l-4 border-l-green-500">
                    <div class="w-10 h-10 rounded-xl bg-green-500/10 flex items-center justify-center mb-2">
                        <i class="fas fa-bolt text-green-500"></i>
                    </div>
                    <span class="text-[10px] text-gray-400 font-bold uppercase">Payment Speed</span>
                    <span class="text-sm font-bold text-white">Fast</span>
                </div>
            </div>

            <div class="glass-card p-5 rounded-2xl border border-gray-800">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-8 h-8 rounded-lg bg-red-500/10 flex items-center justify-center">
                        <i class="fas fa-bullhorn text-[#E74C3C] text-sm"></i>
                    </div>
                    <h3 class="text-sm font-bold text-white uppercase tracking-tight">System Update</h3>
                </div>
                <p class="text-xs text-gray-400 leading-relaxed font-light">
                    Join our official Telegram community for daily payment proofs and exclusive reward codes.
                </p>
                <a id="tg-link" href="#" target="_blank" class="mt-4 block text-center py-3 bg-gray-800 hover:bg-gray-700 text-white rounded-xl text-xs font-bold border border-gray-700 transition-all btn-press">
                    <i class="fab fa-telegram-plane mr-2 text-blue-400"></i> JOIN TELEGRAM
                </a>
            </div>
        </section>

        <!-- Tasks Tab -->
        <section id="tasks" class="tab-content space-y-6">
            <div class="text-center py-4">
                <h2 class="text-2xl font-black text-white tracking-tight">Reward Center</h2>
                <p class="text-gray-400 text-sm font-light">Watch ads and claim your earnings</p>
            </div>

            <div class="glass-card overflow-hidden rounded-3xl border border-gray-800 shadow-2xl">
                <div class="guava-gradient h-2.5"></div>
                <div class="p-8">
                    <div class="flex justify-between items-start mb-6">
                        <div class="flex flex-col">
                            <h3 class="text-xl font-bold text-white">Daily Ad Bonus</h3>
                            <p class="text-gray-400 text-xs font-light mt-1">Watch a 15s ad to get instant reward.</p>
                        </div>
                        <div class="bg-[#E74C3C]/10 px-4 py-2 rounded-2xl border border-[#E74C3C]/30 shadow-inner">
                            <span id="ad-value-badge" class="text-[#E74C3C] font-black text-lg balance-text">à§³0.50</span>
                        </div>
                    </div>

                    <button id="watch-ad-btn" class="w-full py-5 rounded-2xl flex items-center justify-center gap-3 font-black guava-gradient text-white shadow-xl shadow-red-900/40 btn-press text-sm tracking-widest">
                        <i class="fas fa-play-circle text-xl"></i>
                        <span>WATCH AD TO EARN</span>
                    </button>

                    <div id="ad-success" class="hidden mt-6 p-4 bg-green-500/10 border border-green-500/30 rounded-2xl flex items-center gap-3 text-green-500 animate-pulse">
                        <i class="fas fa-check-circle text-lg"></i>
                        <span class="text-xs font-bold uppercase tracking-wider">Balance Updated Successfully!</span>
                    </div>
                </div>
            </div>

            <div class="glass-card p-6 rounded-3xl">
                <h4 class="text-xs font-black text-white mb-4 uppercase tracking-[0.2em] opacity-50">Guidebook</h4>
                <div class="space-y-4">
                    <div class="flex gap-4 items-start">
                        <div class="w-7 h-7 rounded-lg bg-gray-800 border border-gray-700 flex-shrink-0 flex items-center justify-center text-[#E74C3C] text-xs font-black">1</div>
                        <p class="text-xs text-gray-400 leading-normal font-light">Press the <span class="text-white font-medium">Watch Ad</span> button and wait for the provider to load content.</p>
                    </div>
                    <div class="flex gap-4 items-start">
                        <div class="w-7 h-7 rounded-lg bg-gray-800 border border-gray-700 flex-shrink-0 flex items-center justify-center text-[#E74C3C] text-xs font-black">2</div>
                        <p class="text-xs text-gray-400 leading-normal font-light">Do not close the application while the ad is playing to ensure reward credit.</p>
                    </div>
                    <div class="flex gap-4 items-start">
                        <div class="w-7 h-7 rounded-lg bg-gray-800 border border-gray-700 flex-shrink-0 flex items-center justify-center text-[#E74C3C] text-xs font-black">3</div>
                        <p class="text-xs text-gray-400 leading-normal font-light">Rewards are synced instantly with our <span class="text-white font-medium">Global Ledger</span>.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Withdraw Tab -->
        <section id="withdraw" class="tab-content space-y-6">
            <div class="text-center py-4">
                <h2 class="text-2xl font-black text-white tracking-tight">Withdraw Funds</h2>
                <p class="text-gray-400 text-sm font-light">Fast & Secure Payouts</p>
            </div>

            <div class="glass-card p-8 rounded-3xl">
                <div class="flex justify-between items-center mb-8">
                    <span class="text-gray-400 text-xs font-bold uppercase tracking-wider">Current Balance</span>
                    <span id="withdraw-balance" class="text-3xl font-black text-[#E74C3C] balance-text">à§³0.00</span>
                </div>

                <form id="withdraw-form" class="space-y-6">
                    <div>
                        <label class="block text-[10px] font-black text-gray-400 mb-3 uppercase tracking-[0.15em]">Select Payout Method</label>
                        <div class="grid grid-cols-2 gap-4">
                            <button type="button" onclick="setWithdrawMethod('Bkash')" id="btn-bkash" class="py-4 rounded-2xl border-2 font-black transition-all text-xs bg-[#E74C3C]/5 border-[#E74C3C] text-[#E74C3C] btn-press">bKash</button>
                            <button type="button" onclick="setWithdrawMethod('Nagad')" id="btn-nagad" class="py-4 rounded-2xl border-2 font-black transition-all text-xs bg-transparent border-gray-700 text-gray-500 btn-press">Nagad</button>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div class="relative">
                            <label class="block text-[10px] font-black text-gray-400 mb-2 uppercase tracking-[0.15em]">Withdrawal Amount (à§³)</label>
                            <input type="number" id="withdraw-amount" placeholder="0.00" class="w-full bg-gray-900/50 border border-gray-700 focus:border-[#E74C3C] rounded-2xl px-5 py-4 text-white text-sm font-bold transition-all outline-none">
                        </div>

                        <div class="relative">
                            <label class="block text-[10px] font-black text-gray-400 mb-2 uppercase tracking-[0.15em]">Personal Account Number</label>
                            <input type="tel" id="withdraw-number" placeholder="01XXXXXXXXX" class="w-full bg-gray-900/50 border border-gray-700 focus:border-[#E74C3C] rounded-2xl px-5 py-4 text-white text-sm font-bold transition-all outline-none">
                        </div>
                    </div>

                    <button type="submit" id="withdraw-submit" class="w-full py-5 guava-gradient rounded-2xl text-white font-black shadow-xl shadow-red-900/30 btn-press text-sm tracking-widest mt-4">
                        REQUEST CASHOUT
                    </button>
                    
                    <div id="withdraw-msg" class="hidden p-4 rounded-2xl text-center text-[11px] font-bold uppercase tracking-widest border"></div>
                </form>
            </div>

            <div class="p-5 bg-yellow-500/5 border border-yellow-500/20 rounded-2xl flex gap-4">
                <i class="fas fa-shield-alt text-yellow-500 text-lg"></i>
                <div>
                    <h5 class="text-xs font-black text-yellow-500 uppercase tracking-wider mb-1">Security Alert</h5>
                    <p class="text-[10px] text-gray-400 leading-relaxed font-light">Withdrawals are processed manually to ensure safety. Please allow <span class="text-white">6-24 hours</span> for the funds to reach your account.</p>
                </div>
            </div>
        </section>

        <!-- Profile Tab -->
        <section id="profile" class="tab-content space-y-6">
            <div class="text-center pt-8">
                <div class="relative inline-block">
                    <div class="w-28 h-28 guava-gradient rounded-3xl mx-auto flex items-center justify-center border-4 border-[#1B2631] shadow-2xl mb-4 rotate-3">
                        <i class="fas fa-user text-5xl text-white -rotate-3"></i>
                    </div>
                    <div class="absolute -bottom-2 -right-2 bg-green-500 w-8 h-8 rounded-full border-4 border-[#1B2631] flex items-center justify-center">
                        <i class="fas fa-check text-[10px] text-white"></i>
                    </div>
                </div>
                <h2 id="profile-name" class="text-2xl font-black text-white tracking-tight">Premium User</h2>
                <p id="profile-id" class="text-gray-500 text-xs font-mono tracking-widest mt-1 uppercase">UID: Loading...</p>
            </div>

            <div class="glass-card rounded-3xl overflow-hidden border border-gray-800">
                <div class="p-5 border-b border-gray-800/50 flex items-center justify-between">
                    <span class="text-xs font-bold text-gray-400 uppercase tracking-widest">Global Balance</span>
                    <span id="profile-balance" class="text-base font-black text-white">à§³0.00</span>
                </div>
                <div class="p-5 border-b border-gray-800/50 flex items-center justify-between">
                    <span class="text-xs font-bold text-gray-400 uppercase tracking-widest">Min. Cashout</span>
                    <span id="profile-min" class="text-base font-black text-white">à§³20.00</span>
                </div>
                <div class="p-5 flex items-center justify-between bg-white/5">
                    <span class="text-xs font-bold text-gray-400 uppercase tracking-widest">Account Type</span>
                    <span class="px-3 py-1 bg-green-500/10 text-green-500 text-[10px] font-black rounded-lg border border-green-500/20 uppercase">Pro Partner</span>
                </div>
            </div>

            <div class="space-y-3">
                <button onclick="window.open(appData.config.telegramChannel, '_blank')" class="w-full p-5 glass-card rounded-2xl flex items-center justify-between btn-press">
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 rounded-xl bg-blue-500/10 flex items-center justify-center">
                            <i class="fab fa-telegram-plane text-blue-400 text-lg"></i>
                        </div>
                        <span class="text-xs font-bold text-white uppercase tracking-widest">Support Portal</span>
                    </div>
                    <i class="fas fa-external-link-alt text-gray-600 text-[10px]"></i>
                </button>
                <button class="w-full p-5 glass-card rounded-2xl flex items-center justify-between opacity-50">
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 rounded-xl bg-purple-500/10 flex items-center justify-center">
                            <i class="fas fa-history text-purple-400 text-lg"></i>
                        </div>
                        <span class="text-xs font-bold text-white uppercase tracking-widest">Payout History</span>
                    </div>
                    <span class="text-[9px] bg-gray-800 px-2 py-1 rounded-lg border border-gray-700 font-black">LOCKED</span>
                </button>
            </div>

            <div class="text-center pt-8">
                <p class="text-[9px] text-gray-600 uppercase font-black tracking-[0.4em]">Red Guyava Network v1.2.5</p>
                <p class="text-[8px] text-gray-700 mt-2">SECURED BY FIREBASE PROTOCOL</p>
            </div>
        </section>
    </main>

    <!-- Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 glass-card border-t border-gray-800 px-6 py-4 flex justify-between items-center z-50 rounded-t-[32px]">
        <button onclick="switchTab('home')" id="tab-home" class="nav-btn flex flex-col items-center gap-1.5 transition-all duration-300 active-tab">
            <i class="fas fa-home text-xl"></i>
            <span class="text-[9px] font-black uppercase tracking-widest">Home</span>
        </button>
        <button onclick="switchTab('tasks')" id="tab-tasks" class="nav-btn flex flex-col items-center gap-1.5 text-gray-500 transition-all duration-300">
            <i class="fas fa-grid-2 text-xl"></i>
            <span class="text-[9px] font-black uppercase tracking-widest">Tasks</span>
        </button>
        <button onclick="switchTab('withdraw')" id="tab-withdraw" class="nav-btn flex flex-col items-center gap-1.5 text-gray-500 transition-all duration-300">
            <i class="fas fa-wallet text-xl"></i>
            <span class="text-[9px] font-black uppercase tracking-widest">Payout</span>
        </button>
        <button onclick="switchTab('profile')" id="tab-profile" class="nav-btn flex flex-col items-center gap-1.5 text-gray-500 transition-all duration-300">
            <i class="fas fa-user-circle text-xl"></i>
            <span class="text-[9px] font-black uppercase tracking-widest">Me</span>
        </button>
    </nav>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue, set, push, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // Firebase Configuration (Replace with your actual keys if needed)
        const firebaseConfig = {
            apiKey: "AIzaSyATWNF5R1SxJ2TG6iONpuy7R_OHnJcOeKs",
            authDomain: "red-guyava-earning.firebaseapp.com",
            databaseURL: "https://red-guyava-earning-default-rtdb.firebaseio.com",
            projectId: "red-guyava-earning",
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // Core State
        window.appData = {
            user: { id: 88888888, name: "Premium Member", balance: 0 },
            config: { 
                adValue: 0.5, 
                welcomeMsg: "Welcome to the elite Red Guyava network.", 
                minWithdraw: 20, 
                telegramChannel: "https://t.me/red_guyava" 
            },
            withdrawMethod: 'Bkash'
        };

        // UI Selectors
        const ui = {
            balances: document.querySelectorAll('#header-balance, #main-balance, #withdraw-balance, #profile-balance'),
            userName: document.getElementById('user-name'),
            profileName: document.getElementById('profile-name'),
            profileId: document.getElementById('profile-id'),
            welcomeMsg: document.getElementById('welcome-msg'),
            adValueBadge: document.getElementById('ad-value-badge'),
            withdrawMinInput: document.getElementById('withdraw-amount'),
            profileMin: document.getElementById('profile-min'),
            tgLink: document.getElementById('tg-link')
        };

        // Telegram WebApp Integration
        const tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            tg.expand();
            tg.enableClosingConfirmation();
            tg.setHeaderColor('#1B2631');
            tg.setBackgroundColor('#1B2631');
            
            if (tg.initDataUnsafe?.user) {
                appData.user.id = tg.initDataUnsafe.user.id;
                appData.user.name = tg.initDataUnsafe.user.first_name + (tg.initDataUnsafe.user.last_name ? ' ' + tg.initDataUnsafe.user.last_name : '');
            }
        }

        // Global UI Refresh Function
        function updateUI() {
            const formattedBal = `à§³${appData.user.balance.toFixed(2)}`;
            ui.balances.forEach(el => {
                if(el.id === 'main-balance' || el.id === 'withdraw-balance') {
                    el.textContent = `à§³${appData.user.balance.toFixed(2)}`;
                } else {
                    el.textContent = formattedBal;
                }
            });
            ui.userName.textContent = appData.user.name;
            ui.profileName.textContent = appData.user.name;
            ui.profileId.textContent = `UID: ${appData.user.id}`;
            ui.welcomeMsg.textContent = appData.config.welcomeMsg;
            ui.adValueBadge.textContent = `à§³${appData.config.adValue.toFixed(2)}`;
            ui.profileMin.textContent = `à§³${appData.config.minWithdraw.toFixed(2)}`;
            ui.withdrawMinInput.placeholder = `Minimum à§³${appData.config.minWithdraw}`;
            ui.tgLink.href = appData.config.telegramChannel;
        }

        // Firebase Initialization & Realtime Sync
        function initAppSync() {
            // Global Config Sync
            onValue(ref(db, 'config'), (snapshot) => {
                if (snapshot.exists()) {
                    appData.config = { ...appData.config, ...snapshot.val() };
                    updateUI();
                }
            });

            // User Profile Sync
            const userRef = ref(db, `users/${appData.user.id}`);
            onValue(userRef, (snapshot) => {
                if (snapshot.exists()) {
                    appData.user = { ...appData.user, ...snapshot.val() };
                } else {
                    // Create new user if not exists
                    set(userRef, {
                        id: appData.user.id,
                        name: appData.user.name,
                        balance: 0,
                        createdAt: Date.now()
                    });
                }
                updateUI();
            });
        }

        // Tab Switching Engine
        window.switchTab = (tabId) => {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(el => {
                el.classList.remove('active-tab', 'text-[#E74C3C]');
                el.classList.add('text-gray-500');
            });
            
            const activeBtn = document.getElementById(`tab-${tabId}`);
            activeBtn.classList.add('active-tab', 'text-[#E74C3C]');
            activeBtn.classList.remove('text-gray-500');
            
            tg?.HapticFeedback?.impactOccurred('medium');
            window.scrollTo(0, 0);
        };

        // Ad Task Logic (Monetag/Ad Provider ready)
        document.getElementById('watch-ad-btn').onclick = async () => {
            const btn = document.getElementById('watch-ad-btn');
            const success = document.getElementById('ad-success');
            
            tg?.HapticFeedback?.impactOccurred('light');
            btn.disabled = true;
            btn.innerHTML = '<div class="loader"></div> <span class="tracking-widest">LOADING AD...</span>';
            
            // Simulate 3-second ad load and watch
            setTimeout(async () => {
                try {
                    const currentBalance = parseFloat(appData.user.balance) || 0;
                    const increment = parseFloat(appData.config.adValue) || 0.5;
                    const newBalance = currentBalance + increment;
                    
                    await update(ref(db, `users/${appData.user.id}`), { 
                        balance: newBalance,
                        lastActive: Date.now()
                    });
                    
                    btn.disabled = false;
                    btn.innerHTML = '<i class="fas fa-play-circle text-xl"></i> <span>WATCH AD TO EARN</span>';
                    
                    success.classList.remove('hidden');
                    tg?.HapticFeedback?.notificationOccurred('success');
                    setTimeout(() => success.classList.add('hidden'), 4000);
                } catch (error) {
                    console.error("Reward Sync Failed", error);
                    btn.disabled = false;
                    btn.textContent = 'RETRY AD LOAD';
                }
            }, 3000);
        };

        // Payout Logic
        window.setWithdrawMethod = (method) => {
            appData.withdrawMethod = method;
            const bkash = document.getElementById('btn-bkash');
            const nagad = document.getElementById('btn-nagad');
            
            tg?.HapticFeedback?.impactOccurred('light');

            if (method === 'Bkash') {
                bkash.className = "py-4 rounded-2xl border-2 font-black transition-all text-xs bg-[#E74C3C]/5 border-[#E74C3C] text-[#E74C3C] btn-press";
                nagad.className = "py-4 rounded-2xl border-2 font-black transition-all text-xs bg-transparent border-gray-700 text-gray-500 btn-press";
            } else {
                nagad.className = "py-4 rounded-2xl border-2 font-black transition-all text-xs bg-orange-500/5 border-orange-500 text-orange-500 btn-press";
                bkash.className = "py-4 rounded-2xl border-2 font-black transition-all text-xs bg-transparent border-gray-700 text-gray-500 btn-press";
            }
        };

        document.getElementById('withdraw-form').onsubmit = async (e) => {
            e.preventDefault();
            const amountInput = document.getElementById('withdraw-amount');
            const numberInput = document.getElementById('withdraw-number');
            const amount = parseFloat(amountInput.value);
            const number = numberInput.value.trim();
            const msg = document.getElementById('withdraw-msg');
            const btn = document.getElementById('withdraw-submit');

            tg?.HapticFeedback?.impactOccurred('medium');

            if (isNaN(amount) || amount < appData.config.minWithdraw) {
                showMsg(`MINIMUM PAYOUT IS à§³${appData.config.minWithdraw}`, 'error');
                return;
            }
            if (amount > appData.user.balance) {
                showMsg('INSUFFICIENT BALANCE FOR THIS TRANSACTION', 'error');
                return;
            }
            if (number.length < 11) {
                showMsg('PLEASE ENTER A VALID 11-DIGIT NUMBER', 'error');
                return;
            }

            btn.disabled = true;
            btn.innerHTML = '<div class="loader"></div> <span class="ml-2">PROCESSING...</span>';

            try {
                const withdrawRef = push(ref(db, 'withdraws'));
                await set(withdrawRef, {
                    userId: appData.user.id,
                    userName: appData.user.name,
                    amount: amount,
                    method: appData.withdrawMethod,
                    number: number,
                    status: 'pending',
                    createdAt: Date.now()
                });
                
                const newBalance = appData.user.balance - amount;
                await update(ref(db, `users/${appData.user.id}`), { balance: newBalance });

                showMsg('CASHOUT REQUEST SENT SUCCESSFULLY!', 'success');
                amountInput.value = '';
                numberInput.value = '';
                tg?.HapticFeedback?.notificationOccurred('success');
            } catch (err) {
                showMsg('NETWORK ERROR. PLEASE TRY AGAIN LATER.', 'error');
                tg?.HapticFeedback?.notificationOccurred('error');
            } finally {
                btn.disabled = false;
                btn.textContent = 'REQUEST CASHOUT';
            }
        };

        function showMsg(text, type) {
            const msg = document.getElementById('withdraw-msg');
            msg.textContent = text;
            if (type === 'success') {
                msg.className = "p-4 mt-4 rounded-2xl text-center text-[10px] font-black uppercase tracking-widest border border-green-500/30 bg-green-500/10 text-green-500 block";
            } else {
                msg.className = "p-4 mt-4 rounded-2xl text-center text-[10px] font-black uppercase tracking-widest border border-red-500/30 bg-red-500/10 text-red-500 block";
            }
            setTimeout(() => msg.classList.add('hidden'), 5000);
        }

        // Initialize App
        initAppSync();
        updateUI();
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>